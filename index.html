<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Interactive Audio Player</title>
  <style>
    body {
      background: #121212;
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
    }

    #circle-container {
      position: relative;
      width: 300px;
      height: 300px;
    }

    #dial {
      position: absolute;
      top: 0;
      left: 0;
      width: 300px;
      height: 300px;
      border: 2px solid #555;
      border-radius: 50%;
      box-sizing: border-box;
    }

    #handle {
      position: absolute;
      width: 20px;
      height: 20px;
      background: #3a3aff;
      border-radius: 50%;
      transform: translate(-50%, -50%);
      cursor: pointer;
    }

    #fileInput {
      margin-bottom: 20px;
    }

    audio {
      margin-top: 20px;
      width: 80%;
    }
  </style>
</head>
<body>
  <input type="file" id="fileInput" accept="audio/*" />
  <div id="circle-container">
    <div id="dial"></div>
    <div id="handle"></div>
  </div>
  <audio id="audioPlayer" controls></audio>

  <script>
    const fileInput = document.getElementById('fileInput');
    const audioPlayer = document.getElementById('audioPlayer');

    // For circular control
    const container = document.getElementById('circle-container');
    const handle = document.getElementById('handle');

    let dragging = false;

    // convert a point (x,y) relative to container center into angle 0–360
    function pointToAngle(x, y) {
      return Math.atan2(y, x) * (180 / Math.PI) + 90;
      // adjust so 0° is at top; you can tweak offset
    }

    function updateHandle(angle) {
      // Place the handle at angle around the circle
      const radius = container.clientWidth / 2;
      const rad = (angle - 90) * (Math.PI / 180); // shift so 0 is top
      const cx = container.clientWidth / 2;
      const cy = container.clientHeight / 2;
      const x = cx + radius * Math.cos(rad);
      const y = cy + radius * Math.sin(rad);
      handle.style.left = x + 'px';
      handle.style.top = y + 'px';
    }

    handle.addEventListener('mousedown', (e) => {
      dragging = true;
    });

    window.addEventListener('mousemove', (e) => {
      if (!dragging) return;
      const rect = container.getBoundingClientRect();
      const cx = rect.left + rect.width / 2;
      const cy = rect.top + rect.height / 2;
      const x = e.clientX - cx;
      const y = e.clientY - cy;
      let angle = pointToAngle(x, y);
      if (angle < 0) angle += 360;
      updateHandle(angle);

      // Map angle to playback speed:
      // e.g., 0° → 0.5×, 180° → 1.0×, 360° → 2.0× (example mapping)
      const min = 0.5, max = 2.0;
      const speed = min + (angle / 360) * (max - min);
      audioPlayer.playbackRate = speed;
    });

    window.addEventListener('mouseup', () => {
      dragging = false;
    });

    fileInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (!file) return;
      const url = URL.createObjectURL(file);
      audioPlayer.src = url;
    });

    // initialize handle position
    updateHandle(0);
  </script>
</body>
</html>
